(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{789:function(e,t,r){"use strict";r.r(t);var a=r(10),n=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"migration-from-dbtrie-backend-to-postgres-backend"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#migration-from-dbtrie-backend-to-postgres-backend"}},[e._v("#")]),e._v(" Migration from DBTrie backend to Postgres backend")]),e._v(" "),t("blockquote",[t("p",[e._v("[!WARNING]"),t("br"),e._v("\nThe last version to support the migration is "),t("code",[e._v("2.5.2")]),e._v(". If you are running a version newer than this and need to migrate, please upgrade to "),t("code",[e._v("2.5.2")]),e._v(" first.")])]),e._v(" "),t("p",[e._v("For an extended period, NBXplorer depended on an embedded database dubbed DBTrie. This internal database imposed limitations for various reasons, prompting us to upgrade NBXplorer to employ a Postgres backend rather than DBTrie.")]),e._v(" "),t("p",[e._v("Although we continue to support DBTrie, it is now deemed obsolete. We offer a migration pathway for existing deployments.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Command line argument")]),e._v(" "),t("th",[e._v("Environment variable")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("--deleteaftermigration")]),e._v(" "),t("td",[e._v("NBXPLORER_DELETEAFTERMIGRATION=1")]),e._v(" "),t("td",[e._v("Once migration succeed, delete the original DBTrie database (default: false)")])]),e._v(" "),t("tr",[t("td",[e._v("--postgres")]),e._v(" "),t("td",[e._v('NBXPLORER_POSTGRES="..."')]),e._v(" "),t("td",[e._v("The connection string to postgres")])]),e._v(" "),t("tr",[t("td",[e._v("--automigrate")]),e._v(" "),t("td",[e._v("NBXPLORER_AUTOMIGRATE=1")]),e._v(" "),t("td",[e._v("If DBTrie database exists, migrate it (default: false)")])]),e._v(" "),t("tr",[t("td",[e._v("--nomigrateevts")]),e._v(" "),t("td",[e._v("NBXPLORER_NOMIGRATEEVTS=1")]),e._v(" "),t("td",[e._v("Do not migrate the events table (default: false)")])]),e._v(" "),t("tr",[t("td",[e._v("--nomigraterawtxs")]),e._v(" "),t("td",[e._v("NBXPLORER_NOMIGRATERAWTXS=1")]),e._v(" "),t("td",[e._v("Do not migrate the raw bytes of transactions (default: false)")])])])]),e._v(" "),t("p",[t("code",[e._v("automigrate")]),e._v(": will seamlessly determine if a DBTrie database necessitates migration, disregarding the flag if migration is unnecessary or already executed.")]),e._v(" "),t("p",[t("code",[e._v("nomigrateevts")]),e._v(": may be employed for services reliant on NBXplorer that do not query past events, thereby hastening the migration process. (BTCPay Server, for example, does not utilize past events)")]),e._v(" "),t("p",[t("code",[e._v("nomigraterawtxs")]),e._v(": may be utilized if preserving raw transaction bytes is nonessential, consequently expediting migration. Raw transactions are typically crucial for signing with a non-segwit wallet.")]),e._v(" "),t("p",[e._v("The majority of instances will complete migration in under five minutes.")]),e._v(" "),t("p",[e._v("For larger instances, our BTCPay Server's mainnet demo server with 800,000 addresses and 44,000 transactions and the DBTrie database approximating 5GB took roughly 40 minutes.")]),e._v(" "),t("p",[e._v("If you use BTCPay Server, ensure that its environment variable "),t("code",[e._v("BTCPAY_EXPLORERPOSTGRES")]),e._v(" is assigned the same connection string as NBXplorer.")]),e._v(" "),t("p",[e._v("You can find more information in this "),t("a",{attrs:{href:"https://blog.btcpayserver.org/nbxplorer-postgres/",target:"_blank",rel:"noopener noreferrer"}},[e._v("blog post"),t("OutboundLink")],1),e._v(".")])])}),[],!1,null,null,null);t.default=n.exports}}]);