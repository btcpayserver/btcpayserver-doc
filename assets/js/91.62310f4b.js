(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{528:function(t,_,v){t.exports=v.p+"assets/img/nxplorer-schema.49aa7fcd.png"},862:function(t,_,v){"use strict";v.r(_);var e=v(17),a=Object(e.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"documentation-of-sql-schema"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#documentation-of-sql-schema"}},[t._v("#")]),t._v(" Documentation of SQL Schema")]),t._v(" "),_("p",[t._v("Knowing the SQL schema is useful in three situations:")]),t._v(" "),_("ol",[_("li",[t._v("You want to query the schema directly as NBXplorer's API doesn't provide an API endpoint for your needs")]),t._v(" "),_("li",[t._v("You want to do your own indexer on top of it (in a different language or for a crypto we don't support)")]),t._v(" "),_("li",[t._v("You want to create your own API on top of it for features not exposed by NBXplorer's API.")])]),t._v(" "),_("p",[t._v("This model is contained in "),_("a",{attrs:{href:"https://github.com/dgarage/NBXplorer/blob/master/NBXplorer/DBScripts/FullSchema.sql",target:"_blank",rel:"noopener noreferrer"}},[t._v("this SQL script"),_("OutboundLink")],1),t._v(".\nThere are additional comments there about the meaning of columns and views.")]),t._v(" "),_("p",[t._v("Here is a diagram:\n"),_("img",{attrs:{src:v(528),alt:"NBXplorer Database Schema",title:"NBXplorer Database Schema"}})]),t._v(" "),_("p",[t._v("The SQL Schema of NBXplorer is multi-tenant, multi-asset, multi-chain.\nIt is divided in several parts:")]),t._v(" "),_("ul",[_("li",[t._v("Blocks and transactions: "),_("code",[t._v("blks")]),t._v(", "),_("code",[t._v("blks_txs")]),t._v(" and "),_("code",[t._v("txs")])]),t._v(" "),_("li",[t._v("Outputs, Inputs and Scripts: "),_("code",[t._v("ins")]),t._v(", "),_("code",[t._v("outs")]),t._v(", "),_("code",[t._v("ins_outs")]),t._v(", "),_("code",[t._v("scripts")])]),t._v(" "),_("li",[t._v("Descriptors: "),_("code",[t._v("descriptors")]),t._v(", "),_("code",[t._v("descriptors_scripts")])]),t._v(" "),_("li",[t._v("Wallets: "),_("code",[t._v("wallets")]),t._v(", "),_("code",[t._v("wallets_wallets")]),t._v(", "),_("code",[t._v("wallets_descriptors")]),t._v(", "),_("code",[t._v("wallets_scripts")])]),t._v(" "),_("li",[t._v("Double spending detection: "),_("code",[t._v("spent_outs")])])]),t._v(" "),_("p",[t._v("Most if the data in those tables is denormalized for better query performance. The denormalization is handled automatically by triggers.")]),t._v(" "),_("h2",{attrs:{id:"using-wallets-tables"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#using-wallets-tables"}},[t._v("#")]),t._v(" Using wallets tables")]),t._v(" "),_("p",[t._v("A wallet is a collection of "),_("code",[t._v("wallets_descriptors")]),t._v(" and "),_("code",[t._v("wallets_scripts")]),t._v(".\nIf a descriptor belongs to a wallet, then any "),_("code",[t._v("descriptors_scripts")]),t._v(" will be added by trigger in the "),_("code",[t._v("wallets_scripts")]),t._v(".")]),t._v(" "),_("p",[t._v("A descriptor is also called "),_("code",[t._v("output descriptor")]),t._v(" in the Bitcoin jargon, it represents a way to derive a collection of addresses deterministically. How to represent and interpret a descriptor is up to the indexer. (see next part)")]),t._v(" "),_("p",[t._v("It is also possible to add directly scripts to "),_("code",[t._v("wallets_scripts")]),t._v(".")]),t._v(" "),_("p",[t._v("On top of it, a wallet can have children by using "),_("code",[t._v("wallets_wallets")]),t._v(".\nAny script from a child wallet will be added to the scripts of the parent wallet.")]),t._v(" "),_("p",[t._v("This allow you to define a hierarchy of wallet.")]),t._v(" "),_("h2",{attrs:{id:"making-your-own-indexer"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#making-your-own-indexer"}},[t._v("#")]),t._v(" Making your own indexer")]),t._v(" "),_("p",[t._v("An indexer typical flow is the following:")]),t._v(" "),_("ol",[_("li",[t._v("Insert block in blks with "),_("code",[t._v("confirmed='f'")])]),t._v(" "),_("li",[t._v("Call "),_("code",[t._v("fetch_matches")]),t._v(" with all the ins and outs of a block")]),t._v(" "),_("li",[t._v("This will create temporary tables "),_("code",[t._v("matched_outs")]),t._v(", "),_("code",[t._v("matched_ins")]),t._v(" and "),_("code",[t._v("matched_conflicts")]),t._v(" the indexer can use to inspect what has been matched")]),t._v(" "),_("li",[t._v("Call save_matches to instruct the database to insert all matched ins/outs.")]),t._v(" "),_("li",[t._v("Turn "),_("code",[t._v("confirmed='t'")]),t._v(" of the block.")])]),t._v(" "),_("p",[t._v("On top of this, an indexer is responsible for creating "),_("code",[t._v("descriptors_scripts")]),t._v(". It can do so by monitoring "),_("code",[t._v("descriptors.gap")]),t._v(", and if the gap become too low, the indexer need to insert more scripts from the descriptor into "),_("code",[t._v("descriptors_scripts")]),t._v(".")]),t._v(" "),_("p",[t._v("This allow indexer to define their own descriptors.")]),t._v(" "),_("h2",{attrs:{id:"views-and-functions"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#views-and-functions"}},[t._v("#")]),t._v(" Views and functions")]),t._v(" "),_("h3",{attrs:{id:"function-to-btc"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#function-to-btc"}},[t._v("#")]),t._v(" Function: to_btc")]),t._v(" "),_("p",[_("code",[t._v("to_btc(v NUMERIC)")])]),t._v(" "),_("p",[t._v("Helper function format a satoshi based value into numeric bitcoin.")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" to_btc"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("150000000")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("div",{staticClass:"language- extra-class"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[t._v("1.50000000\n")])])]),_("h3",{attrs:{id:"function-get-wallets-recent"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#function-get-wallets-recent"}},[t._v("#")]),t._v(" Function: get_wallets_recent")]),t._v(" "),_("p",[_("code",[t._v("get_wallets_recent(in_wallet_id TEXT, in_interval INTERVAL, in_limit INT, in_offset INT)")])]),t._v(" "),_("p",[_("code",[t._v("get_wallets_recent(in_wallet_id TEXT, in_code TEXT, in_interval INTERVAL, in_limit INT, in_offset INT)")])]),t._v(" "),_("p",[t._v("See what has going on recently in a wallet.")]),t._v(" "),_("p",[t._v("Better to use on Postgres 13+, as it greatly benefits from incremental sort.")]),t._v(" "),_("p",[t._v("For example, this returns the "),_("code",[t._v("5")]),t._v(" most recent "),_("code",[t._v("KPrAFh3ZOIS5umpbwuYkU0sF8JW+")]),t._v(" that happened for one year.")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" get_wallets_recent"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'KPrAFh3ZOIS5umpbwuYkU0sF8JW+'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interval")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1 year'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v('"code"')]),t._v(" "),_("th",[t._v('"asset_id"')]),t._v(" "),_("th",[t._v('"tx_id"')]),t._v(" "),_("th",[t._v('"seen_at"')]),t._v(" "),_("th",[t._v('"balance_change"')]),t._v(" "),_("th",[t._v('"balance_total"')])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"0e42124df086ef05b0d8cb3a5b2028828b3af27b31d7c5045803cc8541410a9f"')]),t._v(" "),_("td",[t._v('"2022-03-07 17:14:27.269382+00"')]),t._v(" "),_("td",[t._v("-199996.0")]),t._v(" "),_("td",[t._v("55020")])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"529d92bcdba7545befa4b1101256544def3ca9726ebbe4a6bd8122d7762129a2"')]),t._v(" "),_("td",[t._v('"2022-03-06 21:15:48.505111+00"')]),t._v(" "),_("td",[t._v("-229995.0")]),t._v(" "),_("td",[t._v("255016")])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"e9ce704adc9c64e099c2513169d6856bbf2fcdb2de92b465d4d63b67961b2bd2"')]),t._v(" "),_("td",[t._v('"2022-03-04 15:07:08.923081+00"')]),t._v(" "),_("td",[t._v("200000")]),t._v(" "),_("td",[t._v("485011")])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"0581c1545ce58ecf93d70e97321fa27c7d409bb0666a124470491403cb0d91f4"')]),t._v(" "),_("td",[t._v('"2022-03-03 10:59:44.259948+00"')]),t._v(" "),_("td",[t._v("230000")]),t._v(" "),_("td",[t._v("285011")])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"c12d1339295d6a69af8dc0fb411b67d5571d31265b385586341a4126bcda76da"')]),t._v(" "),_("td",[t._v('"2022-02-22 17:00:02.697965+00"')]),t._v(" "),_("td",[t._v("-519989.0")]),t._v(" "),_("td",[t._v("55011")])])])]),t._v(" "),_("h3",{attrs:{id:"view-utxos"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#view-utxos"}},[t._v("#")]),t._v(" View: utxos")]),t._v(" "),_("p",[t._v("List all the UTXOs available:")]),t._v(" "),_("p",[_("strong",[t._v("Warning")]),t._v(": It also returns the UTXO that are confirmed but spent in the mempool, as well as immature utxos and utxos that are being double spent.")]),t._v(" "),_("p",[t._v("If you want the available UTXOs which can be spent use "),_("code",[t._v("WHERE input_mempool IS FALSE AND immature IS FALSE")]),t._v(".")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" utxos\n"),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" input_mempool "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v("\n      immature "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v('"code"')]),t._v(" "),_("th",[t._v('"tx_id"')]),t._v(" "),_("th",[t._v('"idx"')]),t._v(" "),_("th",[t._v('"script"')]),t._v(" "),_("th",[t._v('"value"')]),t._v(" "),_("th",[t._v('"asset_id"')]),t._v(" "),_("th",[t._v('"input_tx_id"')]),t._v(" "),_("th",[t._v('"input_idx"')]),t._v(" "),_("th",[t._v('"input_mempool"')]),t._v(" "),_("th",[t._v('"immature"')]),t._v(" "),_("th",[t._v('"blk_id"')]),t._v(" "),_("th",[t._v('"blk_idx"')]),t._v(" "),_("th",[t._v('"blk_height"')]),t._v(" "),_("th",[t._v('"mempool"')]),t._v(" "),_("th",[t._v('"replaced_by"')]),t._v(" "),_("th",[t._v('"seen_at"')])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"6bf5a95c11c819ff22da3933bef2931977b4906c5820bb48ab5336a77502e4a6"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"00144d60ec59ed28267bf897543a659662cddabd384b"')]),t._v(" "),_("td",[t._v("19490")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"0000010e1bc83fa20421880db7424740392a459c6ac699cefe7eac5004247e46"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("58943")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-08 14:25:17.96779+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"6c43019cb584391a766b1c7d5c67f09174d98b4306edeedf8586c8fdbf1048d6"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"0014f8a89fd6d6d256df24e05b01cade70d2abcdb6f6"')]),t._v(" "),_("td",[t._v("113872")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"00000088cb1683d609054866ff72131af46dd7f6ee51136fdc2184f5ad1bbbf6"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("58502")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-05 10:21:39.483849+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"1457ce82a3eb87a8982429e5185896ddee09c773519fa198de3bba4d6c9b42b7"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"0014002ca9212872715f0a5789d52084a9daecb5dce7"')]),t._v(" "),_("td",[t._v("3899577")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"000001090d8f4c50c77021026d5ec5fbe2072cb95a1f5592635f70dfc30297d0"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("59348")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-11 12:30:12.008471+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"75b7ba9a0718a95234e0b72edd2c721f3066be96eb8076f5b8f3f7160498d07f"')]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v('"0014ca76914ddc4fca3c37768e599302765ae633b62c"')]),t._v(" "),_("td",[t._v("119727")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"0000009d64990b4a2b4bff9511d5c9713124905a0932026db5737a3ad44f0138"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("60492")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-19 10:08:54.301111+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"9fc4bc1b9dc2d60202fe4e483b54afb5da7efbbfe6966e5e51f4dc6dbc2363b5"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"0014ad054e107c046e69b5ab5abc1e44d25ac9378ff6"')]),t._v(" "),_("td",[t._v("9900")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"0000010003e91e0f56787b9e02b5ae424bb681f09f2ec82f8e23b19a7a93b6e6"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("53506")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-09-01 02:13:21.469658+00"')])])])]),t._v(" "),_("h3",{attrs:{id:"view-descriptors-scripts-unused"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#view-descriptors-scripts-unused"}},[t._v("#")]),t._v(" View: descriptors_scripts_unused")]),t._v(" "),_("p",[t._v("List all the unused scripts from descriptors.")]),t._v(" "),_("p",[t._v("Example: Get the next unused address:")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" descriptors_scripts_unused\n"),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" code"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BTC'")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" descriptor"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'7obopunl9/6GVYkej++YMw6DHWXk'")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" idx "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OFFSET")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("code")]),t._v(" "),_("th",[t._v("descriptor")]),t._v(" "),_("th",[t._v("script")]),t._v(" "),_("th",[t._v("idx")]),t._v(" "),_("th",[t._v("addr")]),t._v(" "),_("th",[t._v("d_metadata")]),t._v(" "),_("th",[t._v("ds_metadata")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("BTC")]),t._v(" "),_("td",[t._v("7obopunl9/6GVYkej++YMw6DHWXk")]),t._v(" "),_("td",[t._v("001482137a4bbc144f8eb5a02fd2acda36c999a96242")]),t._v(" "),_("td",[t._v("3261")]),t._v(" "),_("td",[t._v("tb1qsgfh5jauz38caddq9lf2ek3kexv6jcjzxu9sfw")]),t._v(" "),_("td",[t._v('{"type": "NBXv1-Derivation", "feature": "Deposit", "derivation": "tpubDCtUtuEgpKLQJMu5uUUuDQub7D4CHjCJsfGhwrA3HV6X6CuV7Zj6RizRFwLPNKqkLrd8TM1Xt3QmwumqRRZAUTrVAA9T8uhyMfodChhFykD", "keyPathTemplate": "0/*"}')]),t._v(" "),_("td")])])]),t._v(" "),_("h3",{attrs:{id:"view-wallets-utxos"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#view-wallets-utxos"}},[t._v("#")]),t._v(" View: wallets_utxos")]),t._v(" "),_("p",[t._v("List all the wallets UTXOs available:")]),t._v(" "),_("p",[_("strong",[t._v("Warning")]),t._v(": It also returns the UTXO that are confirmed but spent in the mempool, as well as immature utxos and utxos that are being double spent.")]),t._v(" "),_("p",[t._v("If you want the available UTXOs which can be spent use "),_("code",[t._v("WHERE input_mempool IS FALSE AND immature IS FALSE")]),t._v(".")]),t._v(" "),_("p",[t._v("Also, keep in mind that if an UTXO belong to two wallets, then you will see two entries for this UTXO.")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" wallets_utxos\n"),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" input_mempool "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v("\n      immature "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("IS")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("FALSE")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v('"wallet_id"')]),t._v(" "),_("th",[t._v('"code"')]),t._v(" "),_("th",[t._v('"tx_id"')]),t._v(" "),_("th",[t._v('"idx"')]),t._v(" "),_("th",[t._v('"script"')]),t._v(" "),_("th",[t._v('"value"')]),t._v(" "),_("th",[t._v('"asset_id"')]),t._v(" "),_("th",[t._v('"input_tx_id"')]),t._v(" "),_("th",[t._v('"input_idx"')]),t._v(" "),_("th",[t._v('"input_mempool"')]),t._v(" "),_("th",[t._v('"immature"')]),t._v(" "),_("th",[t._v('"blk_id"')]),t._v(" "),_("th",[t._v('"blk_idx"')]),t._v(" "),_("th",[t._v('"blk_height"')]),t._v(" "),_("th",[t._v('"mempool"')]),t._v(" "),_("th",[t._v('"replaced_by"')]),t._v(" "),_("th",[t._v('"seen_at"')])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v('"XObUaAdU2HBJk4XHGhIRya3ZObB3"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"6bf5a95c11c819ff22da3933bef2931977b4906c5820bb48ab5336a77502e4a6"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"00144d60ec59ed28267bf897543a659662cddabd384b"')]),t._v(" "),_("td",[t._v("19490")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"0000010e1bc83fa20421880db7424740392a459c6ac699cefe7eac5004247e46"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("58943")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-08 14:25:17.96779+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"XObUaAdU2HBJk4XHGhIRya3ZObB3"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"6c43019cb584391a766b1c7d5c67f09174d98b4306edeedf8586c8fdbf1048d6"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"0014f8a89fd6d6d256df24e05b01cade70d2abcdb6f6"')]),t._v(" "),_("td",[t._v("113872")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"00000088cb1683d609054866ff72131af46dd7f6ee51136fdc2184f5ad1bbbf6"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("58502")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-05 10:21:39.483849+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"ZDP5CJ1pOWLITR1API3aJkEpdQz+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"1457ce82a3eb87a8982429e5185896ddee09c773519fa198de3bba4d6c9b42b7"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"0014002ca9212872715f0a5789d52084a9daecb5dce7"')]),t._v(" "),_("td",[t._v("3899577")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"000001090d8f4c50c77021026d5ec5fbe2072cb95a1f5592635f70dfc30297d0"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("59348")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-11 12:30:12.008471+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"ZDP5CJ1pOWLITR1API3aJkEpdQz+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"75b7ba9a0718a95234e0b72edd2c721f3066be96eb8076f5b8f3f7160498d07f"')]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v('"0014ca76914ddc4fca3c37768e599302765ae633b62c"')]),t._v(" "),_("td",[t._v("119727")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"0000009d64990b4a2b4bff9511d5c9713124905a0932026db5737a3ad44f0138"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("60492")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-19 10:08:54.301111+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"ZDP5CJ1pOWLITR1API3aJkEpdQz+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"9fc4bc1b9dc2d60202fe4e483b54afb5da7efbbfe6966e5e51f4dc6dbc2363b5"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"0014ad054e107c046e69b5ab5abc1e44d25ac9378ff6"')]),t._v(" "),_("td",[t._v("9900")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"0000010003e91e0f56787b9e02b5ae424bb681f09f2ec82f8e23b19a7a93b6e6"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("53506")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-09-01 02:13:21.469658+00"')])]),t._v(" "),_("tr",[_("td",[t._v('"ZDP5CJ1pOWLITR1API3aJkEpdQz+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('"fec5c75b87378068f1d7d3276e90b2579e5fad8854a7002e14c275f3da9823be"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v('"00145674d00638e0da30ae216df4bb539e94cd2d13d1"')]),t._v(" "),_("td",[t._v("1168447")]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v('"000000b43e91de514fec8f9fc418ecb1e0a2b1d14027b01abaad9d4e39e19e8d"')]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v("60590")]),t._v(" "),_("td",[t._v("False")]),t._v(" "),_("td",[t._v("NULL")]),t._v(" "),_("td",[t._v('"2021-10-20 02:18:16.980641+00"')])])])]),t._v(" "),_("h3",{attrs:{id:"view-wallets-balances"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#view-wallets-balances"}},[t._v("#")]),t._v(" View: wallets_balances")]),t._v(" "),_("p",[t._v("See the current balance of wallets.")]),t._v(" "),_("ul",[_("li",[_("code",[t._v("confirmed_balance")]),t._v(" only include the sum of value of all currently confirmed UTXOs.")]),t._v(" "),_("li",[_("code",[t._v("unconfirmed_balance")]),t._v(" will become the next "),_("code",[t._v("confirmed_balance")]),t._v(" of the wallet if all non-double spent transactions get confirmed.")]),t._v(" "),_("li",[_("code",[t._v("immature_balance")]),t._v(" the sum of utxos that can't be spent before they are immature (ie, the UTXO comes from a coinbase that is less than 100 blocks old)")]),t._v(" "),_("li",[_("code",[t._v("available_balance")]),t._v(" is the balance that can be spent. ("),_("code",[t._v("unconfirmed_balance")]),t._v(" - "),_("code",[t._v("immature_balance")]),t._v(")")])]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" wallets_balances\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v('"wallet_id"')]),t._v(" "),_("th",[t._v('"code"')]),t._v(" "),_("th",[t._v('"asset_id"')]),t._v(" "),_("th",[t._v('"unconfirmed_balance"')]),t._v(" "),_("th",[t._v('"confirmed_balance"')]),t._v(" "),_("th",[t._v('"available_balance"')]),t._v(" "),_("th",[t._v('"immature_balance"')])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v('"4Tdfhh5kK8TFKcDVvsp6xdKOFdmA"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("389520")]),t._v(" "),_("td",[t._v("389520")]),t._v(" "),_("td",[t._v("389520")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"7ERM4iRjhk1gmeyHxEJQp0fhzh8z"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("420000000")]),t._v(" "),_("td",[t._v("420000000")]),t._v(" "),_("td",[t._v("420000000")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"IIKKVY87qBLjbaa/KAfUfcNP9HeC"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("100000")]),t._v(" "),_("td",[t._v("100000")]),t._v(" "),_("td",[t._v("100000")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("55020")]),t._v(" "),_("td",[t._v("55020")]),t._v(" "),_("td",[t._v("55020")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"Q+z/7E0DCjazcm5Q7t9wZSoEJ0IP"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("200000")]),t._v(" "),_("td",[t._v("200000")]),t._v(" "),_("td",[t._v("200000")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"XObUaAdU2HBJk4XHGhIRya3ZObB3"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("133362")]),t._v(" "),_("td",[t._v("133362")]),t._v(" "),_("td",[t._v("133362")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"ZDP5CJ1pOWLITR1API3aJkEpdQz+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v("5197651")]),t._v(" "),_("td",[t._v("5197651")]),t._v(" "),_("td",[t._v("5197651")]),t._v(" "),_("td",[t._v("0")])])])]),t._v(" "),_("h3",{attrs:{id:"materialized-view-wallets-history"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#materialized-view-wallets-history"}},[t._v("#")]),t._v(" Materialized view: wallets_history")]),t._v(" "),_("p",[t._v("Provide an history of wallets (time ordered list of wallet_id, code, asset_id, balance-change, total-balance), it only takes into account confirmed transactions.")]),t._v(" "),_("p",[t._v("This materialized view is intensive to refresh (for 220K transactions, it takes around 5 seconds)")]),t._v(" "),_("p",[t._v("This is meant to be used for reports and histograms.\nIf you want the latest history of a wallet, use "),_("code",[t._v("get_wallets_recent")]),t._v(" instead.")]),t._v(" "),_("p",[t._v("To refresh the materialized view, use "),_("code",[t._v("SELECT wallets_history_refresh();")]),t._v(". This will return "),_("code",[t._v("true")]),t._v(" if the view has been refreshed.")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" wallets_history "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" wallet_id"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'KPrAFh3ZOIS5umpbwuYkU0sF8JW+'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v('"wallet_id"')]),t._v(" "),_("th",[t._v('"code"')]),t._v(" "),_("th",[t._v('"asset_id"')]),t._v(" "),_("th",[t._v('"tx_id"')]),t._v(" "),_("th",[t._v('"seen_at"')]),t._v(" "),_("th",[t._v('"balance_change"')]),t._v(" "),_("th",[t._v('"balance_total"')]),t._v(" "),_("th",[t._v('"nth"')])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"0e42124df086ef05b0d8cb3a5b2028828b3af27b31d7c5045803cc8541410a9f"')]),t._v(" "),_("td",[t._v('"2022-03-07 17:14:27.269382+00"')]),t._v(" "),_("td",[t._v("-199996")]),t._v(" "),_("td",[t._v("55020")]),t._v(" "),_("td",[t._v("10")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"529d92bcdba7545befa4b1101256544def3ca9726ebbe4a6bd8122d7762129a2"')]),t._v(" "),_("td",[t._v('"2022-03-06 21:15:48.505111+00"')]),t._v(" "),_("td",[t._v("-229995")]),t._v(" "),_("td",[t._v("255016")]),t._v(" "),_("td",[t._v("9")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"e9ce704adc9c64e099c2513169d6856bbf2fcdb2de92b465d4d63b67961b2bd2"')]),t._v(" "),_("td",[t._v('"2022-03-04 15:07:08.923081+00"')]),t._v(" "),_("td",[t._v("200000")]),t._v(" "),_("td",[t._v("485011")]),t._v(" "),_("td",[t._v("8")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"0581c1545ce58ecf93d70e97321fa27c7d409bb0666a124470491403cb0d91f4"')]),t._v(" "),_("td",[t._v('"2022-03-03 10:59:44.259948+00"')]),t._v(" "),_("td",[t._v("230000")]),t._v(" "),_("td",[t._v("285011")]),t._v(" "),_("td",[t._v("7")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"c12d1339295d6a69af8dc0fb411b67d5571d31265b385586341a4126bcda76da"')]),t._v(" "),_("td",[t._v('"2022-02-22 17:00:02.697965+00"')]),t._v(" "),_("td",[t._v("-519989")]),t._v(" "),_("td",[t._v("55011")]),t._v(" "),_("td",[t._v("6")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"081466d46632b56d28260b928fea87addeed24cfd25e3d6504b5ddfacf6176e1"')]),t._v(" "),_("td",[t._v('"2022-02-04 10:42:31.059182+00"')]),t._v(" "),_("td",[t._v("310000")]),t._v(" "),_("td",[t._v("575000")]),t._v(" "),_("td",[t._v("5")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"f0165974071064b32122449dbf72a67ab884723923e8536efb5cf4301bcb7469"')]),t._v(" "),_("td",[t._v('"2022-02-04 10:22:04.47652+00"')]),t._v(" "),_("td",[t._v("164000")]),t._v(" "),_("td",[t._v("265000")]),t._v(" "),_("td",[t._v("4")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"a4e165729e5fb406d878b3c9c8dfabd1a3465084c2c2b63602fd8704c41442ac"')]),t._v(" "),_("td",[t._v('"2022-02-04 09:40:00.427892+00"')]),t._v(" "),_("td",[t._v("101000")]),t._v(" "),_("td",[t._v("101000")]),t._v(" "),_("td",[t._v("3")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"61247ae11a770963ffa26a63bb4ac03a14f759f7691eda8ce10175db6b6aaa77"')]),t._v(" "),_("td",[t._v('"2021-10-11 13:09:22.977488+00"')]),t._v(" "),_("td",[t._v("-850000")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("2")])]),t._v(" "),_("tr",[_("td",[t._v('"KPrAFh3ZOIS5umpbwuYkU0sF8JW+"')]),t._v(" "),_("td",[t._v('"BTC"')]),t._v(" "),_("td",[t._v('""')]),t._v(" "),_("td",[t._v('"6bf5a95c11c819ff22da3933bef2931977b4906c5820bb48ab5336a77502e4a6"')]),t._v(" "),_("td",[t._v('"2021-10-08 14:25:17.96779+00"')]),t._v(" "),_("td",[t._v("850000")]),t._v(" "),_("td",[t._v("850000")]),t._v(" "),_("td",[t._v("1")])])])]),t._v(" "),_("h3",{attrs:{id:"function-get-wallets-histogram"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#function-get-wallets-histogram"}},[t._v("#")]),t._v(" Function: get_wallets_histogram")]),t._v(" "),_("p",[_("code",[t._v("get_wallets_histogram(in_wallet_id TEXT, in_code TEXT, in_asset_id TEXT, in_from TIMESTAMPTZ, in_to TIMESTAMPTZ, in_interval INTERVAL)")])]),t._v(" "),_("p",[t._v("This function depends on "),_("code",[t._v("wallets_history")]),t._v(", as such, you should make sure the materialized view is refreshed time for up-to-date histogram.")]),t._v(" "),_("p",[t._v("For example, this will show how the balance of "),_("code",[t._v("KPrAFh3ZOIS5umpbwuYkU0sF8JW+")]),t._v(" changed every week from "),_("code",[t._v("2022-01-23")]),t._v(" to now.")]),t._v(" "),_("div",{staticClass:"language-SQL extra-class"},[_("pre",{pre:!0,attrs:{class:"language-sql"}},[_("code",[_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" get_wallets_histogram"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'KPrAFh3ZOIS5umpbwuYkU0sF8JW+'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BTC'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2022-01-23'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CURRENT_TIMESTAMP")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interval")]),t._v(" "),_("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1 week'")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),_("p",[t._v("Output:")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v('"date"')]),t._v(" "),_("th",[t._v('"balance_change"')]),t._v(" "),_("th",[t._v('"balance"')])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v('"2022-01-23 00:00:00+00"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-01-30 00:00:00+00"')]),t._v(" "),_("td",[t._v("575000")]),t._v(" "),_("td",[t._v("575000")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-02-06 00:00:00+00"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("575000")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-02-13 00:00:00+00"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("575000")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-02-20 00:00:00+00"')]),t._v(" "),_("td",[t._v("-519989")]),t._v(" "),_("td",[t._v("55011")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-02-27 00:00:00+00"')]),t._v(" "),_("td",[t._v("430000")]),t._v(" "),_("td",[t._v("485011")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-03-06 00:00:00+00"')]),t._v(" "),_("td",[t._v("-429991")]),t._v(" "),_("td",[t._v("55020")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-03-13 00:00:00+00"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("55020")])]),t._v(" "),_("tr",[_("td",[t._v('"2022-03-20 00:00:00+00"')]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("55020")])])])]),t._v(" "),_("h3",{attrs:{id:"function-nbxv1-get-wallet-id"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#function-nbxv1-get-wallet-id"}},[t._v("#")]),t._v(" Function: nbxv1_get_wallet_id")]),t._v(" "),_("p",[_("code",[t._v("nbxv1_get_wallet_id(in_code TEXT, in_scheme_or_address TEXT) RETURNS TEXT")])]),t._v(" "),_("p",[t._v("This function is specific to the current API of NBXplorer. It calculates the "),_("code",[t._v("wallet_id")]),t._v(" based on the chain code (ie. "),_("code",[t._v("BTC")]),t._v(") and an address or derivation scheme.")]),t._v(" "),_("h3",{attrs:{id:"function-nbxv1-get-descriptor-id"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#function-nbxv1-get-descriptor-id"}},[t._v("#")]),t._v(" Function: nbxv1_get_descriptor_id")]),t._v(" "),_("p",[_("code",[t._v("nbxv1_get_descriptor_id(in_code TEXT, in_scheme TEXT, in_feature TEXT) RETURNS TEXT")])]),t._v(" "),_("p",[t._v("This function is specific to the current API of NBXplorer. It calculates the "),_("code",[t._v("descriptor_id")]),t._v(" based on the chain code (ie. "),_("code",[t._v("BTC")]),t._v("), a derivation scheme, and the feature (ie. "),_("code",[t._v("Deposit")]),t._v(" or "),_("code",[t._v("Change")]),t._v(").")])])}),[],!1,null,null,null);_.default=a.exports}}]);