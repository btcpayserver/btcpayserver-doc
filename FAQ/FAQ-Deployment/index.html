<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BTCPay Deployment Frequently Asked Questions | BTCPay Server Docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="/styles/btcpayserver-variables.css">
    <meta name="description" content="BTCPay Server Official Documentation">
    <meta property="og:site_name" content="BTCPay Server Docs">
    <meta property="og:title" content="BTCPay Deployment Frequently Asked Questions">
    <meta property="og:description" content="This document covers the most common questions, errors, and issues you may encounter prior and during the installation of the software. For a detailed list of deployment methods and instructions for each, please see Deployment page../Deployment.md.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://docs.btcpayserver.org/FAQ/FAQ-Deployment/">
    <meta property="og:image" content="https://docs.btcpayserver.org/card.png">
    <meta name="twitter:title" content="BTCPay Deployment Frequently Asked Questions">
    <meta name="twitter:description" content="This document covers the most common questions, errors, and issues you may encounter prior and during the installation of the software. For a detailed list of deployment methods and instructions for each, please see Deployment page../Deployment.md.">
    <meta name="twitter:url" content="https://docs.btcpayserver.org/FAQ/FAQ-Deployment/">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://docs.btcpayserver.org/card.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="BTCPay Server Docs">
    <meta name="twitter:creator" content="btcpayserver">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="BTCPay Server">
    <meta property="article:tag" content="BTCPay Server">
    
    <link rel="preload" href="/assets/css/0.styles.aa878b9c.css" as="style"><link rel="preload" href="/assets/js/app.3e743670.js" as="script"><link rel="preload" href="/assets/js/3.aa1712e0.js" as="script"><link rel="preload" href="/assets/js/76.e7ae2c11.js" as="script"><link rel="preload" href="/assets/js/28.ed6af585.js" as="script"><link rel="prefetch" href="/assets/js/10.3a0a5d27.js"><link rel="prefetch" href="/assets/js/11.b1b70333.js"><link rel="prefetch" href="/assets/js/12.fbb2d827.js"><link rel="prefetch" href="/assets/js/13.12a8698e.js"><link rel="prefetch" href="/assets/js/14.3ce62c2f.js"><link rel="prefetch" href="/assets/js/15.af63728e.js"><link rel="prefetch" href="/assets/js/16.07a14b03.js"><link rel="prefetch" href="/assets/js/17.a8920303.js"><link rel="prefetch" href="/assets/js/18.e0b1b1ec.js"><link rel="prefetch" href="/assets/js/19.abd6aa6d.js"><link rel="prefetch" href="/assets/js/20.d3ed4617.js"><link rel="prefetch" href="/assets/js/21.e078310c.js"><link rel="prefetch" href="/assets/js/22.310d1a38.js"><link rel="prefetch" href="/assets/js/23.93964d5d.js"><link rel="prefetch" href="/assets/js/24.ef7f693b.js"><link rel="prefetch" href="/assets/js/25.c62a0aa4.js"><link rel="prefetch" href="/assets/js/26.93ad068b.js"><link rel="prefetch" href="/assets/js/27.d34e5e35.js"><link rel="prefetch" href="/assets/js/29.1927e873.js"><link rel="prefetch" href="/assets/js/30.3d119335.js"><link rel="prefetch" href="/assets/js/31.a3699e8e.js"><link rel="prefetch" href="/assets/js/32.7e916537.js"><link rel="prefetch" href="/assets/js/33.6b95d9f1.js"><link rel="prefetch" href="/assets/js/34.a64b838b.js"><link rel="prefetch" href="/assets/js/35.7c8fa13d.js"><link rel="prefetch" href="/assets/js/36.30643837.js"><link rel="prefetch" href="/assets/js/37.b86058d8.js"><link rel="prefetch" href="/assets/js/38.d8a24972.js"><link rel="prefetch" href="/assets/js/39.39ffaad0.js"><link rel="prefetch" href="/assets/js/4.32b4e6f9.js"><link rel="prefetch" href="/assets/js/40.326657e1.js"><link rel="prefetch" href="/assets/js/41.1ec23881.js"><link rel="prefetch" href="/assets/js/42.a2429534.js"><link rel="prefetch" href="/assets/js/43.d82659dc.js"><link rel="prefetch" href="/assets/js/44.62c03fa6.js"><link rel="prefetch" href="/assets/js/45.32d3962a.js"><link rel="prefetch" href="/assets/js/46.33bb47d4.js"><link rel="prefetch" href="/assets/js/47.53b2b36d.js"><link rel="prefetch" href="/assets/js/48.0274a01c.js"><link rel="prefetch" href="/assets/js/49.8ec72738.js"><link rel="prefetch" href="/assets/js/5.3a8c8f4b.js"><link rel="prefetch" href="/assets/js/50.53cfdd93.js"><link rel="prefetch" href="/assets/js/51.9a71d339.js"><link rel="prefetch" href="/assets/js/52.1d073968.js"><link rel="prefetch" href="/assets/js/53.1266553e.js"><link rel="prefetch" href="/assets/js/54.6f9a3666.js"><link rel="prefetch" href="/assets/js/55.b7d0ab4b.js"><link rel="prefetch" href="/assets/js/56.f9d9f536.js"><link rel="prefetch" href="/assets/js/57.dfe9eb68.js"><link rel="prefetch" href="/assets/js/58.98363b8a.js"><link rel="prefetch" href="/assets/js/59.539a99cb.js"><link rel="prefetch" href="/assets/js/6.2b5d9249.js"><link rel="prefetch" href="/assets/js/60.5d34424d.js"><link rel="prefetch" href="/assets/js/61.e828e58a.js"><link rel="prefetch" href="/assets/js/62.67d4d43d.js"><link rel="prefetch" href="/assets/js/63.0d098f54.js"><link rel="prefetch" href="/assets/js/64.48dbc6c2.js"><link rel="prefetch" href="/assets/js/65.98ed2be4.js"><link rel="prefetch" href="/assets/js/66.acf9dd81.js"><link rel="prefetch" href="/assets/js/67.365a5a7e.js"><link rel="prefetch" href="/assets/js/68.fe0dd8cc.js"><link rel="prefetch" href="/assets/js/69.e714b843.js"><link rel="prefetch" href="/assets/js/7.8964f754.js"><link rel="prefetch" href="/assets/js/70.eaf0d684.js"><link rel="prefetch" href="/assets/js/71.db7c72c5.js"><link rel="prefetch" href="/assets/js/72.6a51ce83.js"><link rel="prefetch" href="/assets/js/73.1f772bd8.js"><link rel="prefetch" href="/assets/js/74.4caaf1f4.js"><link rel="prefetch" href="/assets/js/75.540c7ae1.js"><link rel="prefetch" href="/assets/js/77.a9920ba7.js"><link rel="prefetch" href="/assets/js/78.a922a4ae.js"><link rel="prefetch" href="/assets/js/79.08cf98ca.js"><link rel="prefetch" href="/assets/js/8.2a1e7b10.js"><link rel="prefetch" href="/assets/js/80.56fbed8c.js"><link rel="prefetch" href="/assets/js/81.a1320e9b.js"><link rel="prefetch" href="/assets/js/82.da6c518d.js"><link rel="prefetch" href="/assets/js/83.2bc79146.js"><link rel="prefetch" href="/assets/js/84.17126a4b.js"><link rel="prefetch" href="/assets/js/85.66f91d91.js"><link rel="prefetch" href="/assets/js/86.32ac9882.js"><link rel="prefetch" href="/assets/js/87.1d161495.js"><link rel="prefetch" href="/assets/js/88.c1f12b5f.js"><link rel="prefetch" href="/assets/js/89.a318c3fc.js"><link rel="prefetch" href="/assets/js/9.c4ffd9e7.js"><link rel="prefetch" href="/assets/js/90.c30abebb.js"><link rel="prefetch" href="/assets/js/91.1633d59a.js"><link rel="prefetch" href="/assets/js/92.f1745853.js"><link rel="prefetch" href="/assets/js/93.cbff83c7.js"><link rel="prefetch" href="/assets/js/94.964fd8e6.js"><link rel="prefetch" href="/assets/js/95.eaca7976.js"><link rel="prefetch" href="/assets/js/96.c788081d.js"><link rel="prefetch" href="/assets/js/97.741a1b7e.js"><link rel="prefetch" href="/assets/js/98.b1eb9e6e.js"><link rel="prefetch" href="/assets/js/99.e6f02097.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.3818bd5d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aa878b9c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/btcpay-logo.svg" alt="BTCPay Server Docs" class="logo"> <span class="site-name can-hide">BTCPay Server Docs</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://btcpayserver.org/" target="_blank" rel="noopener noreferrer website" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://chat.btcpayserver.org/" target="_blank" rel="noopener noreferrer chat" class="nav-link external">
  Chat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/btcpayserver/" target="_blank" rel="noopener noreferrer github" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://twitter.com/BtcpayServer" target="_blank" rel="noopener noreferrer twitter" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/btcpayserver/btcpayserver-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://btcpayserver.org/" target="_blank" rel="noopener noreferrer website" class="nav-link external">
  Website
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://chat.btcpayserver.org/" target="_blank" rel="noopener noreferrer chat" class="nav-link external">
  Chat
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/btcpayserver/" target="_blank" rel="noopener noreferrer github" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://twitter.com/BtcpayServer" target="_blank" rel="noopener noreferrer twitter" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/btcpayserver/btcpayserver-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Introduction</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Basics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/UseCase/" class="sidebar-link">Use Case</a></li><li><a href="/Walkthrough/" class="sidebar-link">Walkthrough</a></li><li><a href="/BTCPayVsOthers/" class="sidebar-link">BTCPay Server vs. Others</a></li><li><a href="/TryItOut/" class="sidebar-link">Try it out</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Deployment</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Deployment/" class="sidebar-link">Choosing a Deployment Method</a></li><li><a href="/ThirdPartyHosting/" class="sidebar-link">Third-party Hosting</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/Docker/" class="sidebar-heading clickable"><span>Docker</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/LunaNodeWebDeployment/" class="sidebar-link">Web Deployment</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/AzureDeployment" class="sidebar-heading clickable"><span>Azure Deployment</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/GoogleCloudDeployment/" class="sidebar-link">Google Cloud Deployment</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/HardwareDeployment" class="sidebar-heading clickable"><span>Hardware Deployment</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/RaspberryPiDeployment" class="sidebar-heading clickable"><span>Raspberry Pi Deployment</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading"><span>Docker Plugins</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/ManualDeployment" class="sidebar-heading clickable"><span>Manual Deployment</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/Configurator/" class="sidebar-link">Configurator</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/RegisterAccount/" class="sidebar-link">(1) Register account</a></li><li><a href="/CreateStore/" class="sidebar-link">(2) Create a store</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/WalletSetup" class="sidebar-heading clickable"><span>(3) Wallet Setup</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/HardwareWalletIntegration/" class="sidebar-link">Connect an existing wallet</a></li><li><a href="/HotWallet/" class="sidebar-link">Create a new wallet</a></li></ul></section></li><li><a href="/WhatsNext/" class="sidebar-link">(4) What's Next?</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Features</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Apps/" class="sidebar-link">Apps</a></li><li><a href="/Wallet/" class="sidebar-link">Wallet</a></li><li><a href="/Invoices/" class="sidebar-link">Invoices</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/PullPayments" class="sidebar-heading clickable"><span>Pull Payments</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/PaymentRequests/" class="sidebar-link">Payment Requests</a></li><li><a href="/LightningNetwork/" class="sidebar-link">Lightning Network</a></li><li><a href="/Accounting/" class="sidebar-link">Accounting</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Payjoin" class="sidebar-heading clickable"><span>Payjoin</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Integrations</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/WooCommerce/" class="sidebar-link">WooCommerce</a></li><li><a href="/Shopify/" class="sidebar-link">Shopify</a></li><li><a href="/Drupal/" class="sidebar-link">Drupal</a></li><li><a href="/Magento/" class="sidebar-link">Magento</a></li><li><a href="/PrestaShop/" class="sidebar-link">PrestaShop</a></li><li><a href="https://github.com/lampsolutions/LampSBtcPayShopware" target="_blank" rel="noopener noreferrer" class="sidebar-link">Shopware<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li><a href="/CustomIntegration/" class="sidebar-link">Custom Integration</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Support and Community</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/FAQ" class="sidebar-heading clickable router-link-active open"><span>FAQ and common issues</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/FAQ/FAQ-General/" class="sidebar-link">General FAQ</a></li><li><a href="/FAQ/FAQ-Deployment/" aria-current="page" class="active sidebar-link">Deployment FAQ</a></li><li><a href="/FAQ/FAQ-Synchronization/" class="sidebar-link">Synchronization FAQ</a></li><li><a href="/FAQ/FAQ-Integrations/" class="sidebar-link">Integrations FAQ</a></li><li><a href="/FAQ/FAQ-ServerSettings/" class="sidebar-link">Server Settings FAQ</a></li><li><a href="/FAQ/FAQ-Stores/" class="sidebar-link">Stores FAQ</a></li><li><a href="/FAQ/FAQ-Wallet/" class="sidebar-link">Wallet FAQ</a></li><li><a href="/FAQ/FAQ-Apps/" class="sidebar-link">Apps FAQ</a></li><li><a href="/FAQ/FAQ-LightningNetwork/" class="sidebar-link">Lightning Network FAQ</a></li><li><a href="/FAQ/FAQ-Altcoin/" class="sidebar-link">Altcoins FAQ</a></li></ul></section></li><li><a href="/Troubleshooting/" class="sidebar-link">Troubleshooting an issue</a></li><li><a href="/Support/" class="sidebar-link">Support</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Contribute" class="sidebar-heading clickable"><span>Contribute to BTCPay Server</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/Community/" class="sidebar-link">Community</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Development</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Architecture/" class="sidebar-link">Architecture</a></li><li><a href="/LocalDevelopment/" class="sidebar-link">Developing Locally</a></li><li><a href="/Altcoins/" class="sidebar-link">How to add an Altcoin</a></li><li><a href="/Theme/" class="sidebar-link">Customizing Themes</a></li><li><a href="https://docs.btcpayserver.org/API/Greenfield/v1" target="_blank" rel="noopener noreferrer" class="sidebar-link">Greenfield API v1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li><a href="/GreenFieldExample/" class="sidebar-link">Greenfield example with cURL</a></li><li><a href="/BTCPayServer/Security/" class="sidebar-link">Security Disclosures</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="btcpay-deployment-frequently-asked-questions"><a href="#btcpay-deployment-frequently-asked-questions" class="header-anchor">#</a> BTCPay Deployment Frequently Asked Questions</h1> <p>This document covers the most common questions, errors, and issues you may encounter prior and during the installation of the software. For a detailed list of deployment methods and instructions for each, please see <a href="/Deployment/">Deployment page</a>.</p> <h2 id="general-deployment-faq"><a href="#general-deployment-faq" class="header-anchor">#</a> General Deployment FAQ</h2> <p>Here are common questions about installation, regardless of the deployment method.</p> <ul><li><a href="#how-much-does-it-cost-to-run-btcpay-server">How much does it cost to run BTCPay Server?</a></li> <li><a href="#what-are-the-minimal-requirements-for-btcpay">What are the minimal requirements for BTCPay?</a></li> <li><a href="#what-is-the-easiest-method-to-deploy-a-self-hosted-btcpay-server">What is the easiest method to deploy a self-hosted BTCPay Server?</a></li> <li><a href="#how-to-choose-a-proper-deployment-method">How to choose a proper deployment method?</a></li> <li><a href="#can-i-run-btcpay-on-my-own-hardware">Can I run BTCPay on my own hardware?</a></li> <li><a href="#can-i-deploy-btcpay-on-my-existing-vps">Can I deploy BTCPay on my existing VPS?</a></li> <li><a href="#are-there-free-hosts-where-i-can-test">Are there free hosts where I can test?</a></li> <li><a href="#after-initial-deployment-i-cant-register-and-i-dont-have-a-login-yet">After initial deployment, I can't register and I don't have a login yet?</a></li> <li><a href="#how-do-i-activate-tor-on-my-btcpay-server">How do I activate Tor on my BTCPay Server?</a></li> <li><a href="#how-do-i-disable-tor-on-my-btcpay-server">How do I disable Tor on my BTCPay Server?</a></li> <li><a href="#why-activate-tor-does-it-mean-that-nobody-knows-who-i-am">Why activate Tor? Does it mean that nobody knows who I am?</a></li> <li><a href="#how-to-access-the-onion-address-without-clearnet">How to access the .onion address without clearnet?</a></li> <li><a href="#how-can-i-modify-or-deactivate-environment-variables">How can I modify or deactivate environment variables?</a></li> <li><a href="#how-can-i-run-btcpay-on-testnet">How can I run BTCPay on testnet?</a></li> <li><a href="#can-i-start-btcpay-only-when-im-expecting-a-payment">Can I start BTCPay only when I'm expecting a payment?</a></li> <li><a href="#can-i-connect-to-my-btcpay-bitcoin-p2p-on-port-8333">Can I connect to my BTCPay Bitcoin P2P on port 8333?</a></li> <li><a href="#how-can-i-renew-my-ssl-certificate">How can I renew my SSL certificate?</a></li> <li><a href="#can-i-use-an-existing-nginx-server-as-a-reverse-proxy-with-ssl-termination">Can I use an existing Nginx server as a reverse proxy with SSL termination?</a></li></ul> <h2 id="web-deployment-faq"><a href="#web-deployment-faq" class="header-anchor">#</a> Web Deployment FAQ</h2> <h3 id="luna-node-web-deployment-faq"><a href="#luna-node-web-deployment-faq" class="header-anchor">#</a> Luna Node Web Deployment FAQ</h3> <ul><li><a href="#how-to-change-domain-name-on-my-lunanode-btcpay">How to change domain name on my LunaNode BTCPay?</a></li></ul> <h2 id="manual-deployment-faq"><a href="#manual-deployment-faq" class="header-anchor">#</a> Manual Deployment FAQ</h2> <ul><li><a href="#how-to-manually-install-btcpay-on-ubuntu-1804">How to manually install BTCPay on Ubuntu 18.04?</a></li> <li><a href="#how-do-i-completely-uninstall-btcpay-from-a-linux-environment-docker-version">How do I completely uninstall BTCPay from a linux environment (docker version)</a></li> <li><a href="#how-to-deploy-btcpay-server-alongside-existing-bitcoin-node">How to deploy BTCPay Server alongside existing Bitcoin full node?</a></li> <li><a href="#with-the-docker-deployment-how-to-use-a-different-volume-for-the-data">With the docker deployment, how to use a different volume for the data?</a></li> <li><a href="#i-get-503-service-temporarily-unavailable-nginx">I get 503 Service Temporarily Unavailable nginx</a> <ul><li><a href="#cause-1-trying-to-access-my-btcpay-by-ip-address">Cause 1: Trying to access my BTCPay by IP address</a></li> <li><a href="#cause-2-btcpayserver-or-letsencrypt-nginx-proxy-is-not-running">Cause 2: btcpayserver or letsencrypt-nginx-proxy is not running</a></li> <li><a href="#cause-3-btcpay-is-expecting-you-to-access-this-website-from">Cause 3: Error: BTCPay is expecting you to access this website from</a></li> <li><a href="#cause-4-getting-500-nginx-error-on-a-local-server-https-and-for-http-btcpay-is-expecting-you-to-access-this-website-from">Cause 4: Getting 500 nginx error on a local server https and for http BTCPay is expecting you to access this website from</a></li> <li><a href="#cause-5-other">Cause 5: Other</a></li></ul></li></ul> <h2 id="general-deployment"><a href="#general-deployment" class="header-anchor">#</a> General Deployment</h2> <h3 id="how-much-does-it-cost-to-run-btcpay-server"><a href="#how-much-does-it-cost-to-run-btcpay-server" class="header-anchor">#</a> How much does it cost to run BTCPay Server?</h3> <p>BTCPay is a 100% free and open-source software. We do not charge you anything.
However, to run it, you should host it. You can run it as a self-hosted solution on your own local server, or use a cloud hosting provider, which is what a majority of users do. Advanced users can run BTCPay on <a href="/HardwareDeployment/">their own hardware</a>. Less technical users can use <a href="/HardwareAsAService/">Hardware As A Service options</a>. If you do not wish to host your own server, you can use a free <a href="/ThirdPartyHosting/">Third-Party Host</a>. Visit our <a href="/Deployment/">Deployment Page</a> for more information on the various ways in which you can run BTCPay.</p> <h3 id="what-are-the-minimal-requirements-for-btcpay"><a href="#what-are-the-minimal-requirements-for-btcpay" class="header-anchor">#</a> What are the minimal requirements for BTCPay?</h3> <p>If you would like to run Bitcoin and Lightning Network nodes, the minimal requirements are :</p> <ul><li>2GB Ram</li> <li>80 GB of storage <a href="/Docker/#generated-docker-compose">with enabled pruning</a></li> <li>Docker</li></ul> <h3 id="what-is-the-easiest-method-to-deploy-a-self-hosted-btcpay-server"><a href="#what-is-the-easiest-method-to-deploy-a-self-hosted-btcpay-server" class="header-anchor">#</a> What is the easiest method to deploy a self-hosted BTCPay Server?</h3> <p>For beginners, we strongly recommend the <a href="/LunaNodeWebDeployment/">web-deployment</a> if you want a self-hosted solution or a <a href="/ThirdPartyHosting/">third-party host</a>.</p> <p>If you're going to add more than one crypto coin, you need to expand the storage according to that coin(s) blockchain size.</p> <h3 id="how-to-choose-a-proper-deployment-method"><a href="#how-to-choose-a-proper-deployment-method" class="header-anchor">#</a> How to choose a proper deployment method?</h3> <p>Please see the <a href="/Deployment/">Deployment page</a> for comparison of different installation methods and choose the one that suits your needs and skill level the most.</p> <h3 id="can-i-run-btcpay-on-my-own-hardware"><a href="#can-i-run-btcpay-on-my-own-hardware" class="header-anchor">#</a> Can I run BTCPay on my own hardware?</h3> <p>Yes, you can. Check our the <a href="/HardwareDeployment/">Hardware Deployment page</a> for detailed instructions.</p> <h3 id="can-i-deploy-btcpay-on-my-existing-vps"><a href="#can-i-deploy-btcpay-on-my-existing-vps" class="header-anchor">#</a> Can I deploy BTCPay on my existing VPS?</h3> <p>Yes. BTCPay is not limited to the documented deployment methods. You can use whichever hosting solution you prefer, that fits the minimal requirements.</p> <h3 id="are-there-free-hosts-where-i-can-test"><a href="#are-there-free-hosts-where-i-can-test" class="header-anchor">#</a> Are there free hosts where I can test?</h3> <p>On a self-hosted BTCPay, an unlimited amount of users and stores can be attached. Some community users have open registration on their servers for others to use their BTCPay Server mainly for testing and learning. Most of them are community-driven and free. See the <a href="/ThirdPartyHosting/">third-party hosts documentation</a> for more information.</p> <h3 id="after-initial-deployment-i-cant-register-and-i-dont-have-a-login-yet"><a href="#after-initial-deployment-i-cant-register-and-i-dont-have-a-login-yet" class="header-anchor">#</a> After initial deployment, I can't register and I don't have a login yet?</h3> <p>When you deploy your BTCPay Server, you should first register a user (during server synchronization). This user is automatically the server admin. If your BTCPay only shows Login in the header menu, and you are unable to register the first user after initial deployment, someone else has registered on your server as the admin. Although this is unlikely to occur (the user would need to know and watch your BTCPay domain name), they had access to your ssh private keys, thus you should redeploy a new server for security reasons.</p> <h3 id="how-do-i-activate-tor-on-my-btcpay-server"><a href="#how-do-i-activate-tor-on-my-btcpay-server" class="header-anchor">#</a> How do I activate Tor on my BTCPay Server?</h3> <p>Tor is activated by default on the docker deployment.</p> <h3 id="how-do-i-disable-tor-on-my-btcpay-server"><a href="#how-do-i-disable-tor-on-my-btcpay-server" class="header-anchor">#</a> How do I disable Tor on my BTCPay Server?</h3> <p>That's really easy: just log in your instance with SSH, and enter as root the enter following commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">BTCPAYGEN_EXCLUDE_FRAGMENTS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$BTCPAYGEN_EXCLUDE_FRAGMENTS</span>;opt-add-tor&quot;</span>
<span class="token builtin class-name">.</span> btcpay-setup.sh -i
</code></pre></div><p>Then wait a few minutes for the server to restart, and you're done!</p> <h3 id="why-activate-tor-does-it-mean-that-nobody-knows-who-i-am"><a href="#why-activate-tor-does-it-mean-that-nobody-knows-who-i-am" class="header-anchor">#</a> Why activate Tor? Does it mean that nobody knows who I am?</h3> <p>Tor for BTCPay server is intended more as an improvement of the setup process, and allows for more flexibility for hosting on one's own device at home or in an office.</p> <p>Having Tor activated would allow for simpler, plug-and-play usage of BTCPay, as it suppress the need for the following configuration steps:</p> <ul><li>Opening multiple ports on the firewall</li> <li>Configuring the NAT for port redirection to your device on your local network</li> <li>Setting up a DNS entry to get a HTTPS certificate</li> <li>Having a fixed IP for Lightning</li></ul> <p>While these steps are usually not a problem when BTCPay is hosted on a VPS, it can be difficult to solve for non-technical users on home or office networks.</p> <p>Tor just solves all these issues in one shot, all you have to do is plug your device on the local network. It is especially useful for POS application.</p> <p>But if you're looking for perfect privacy and security, <strong>activating Tor with your BTCPay just won't do it.</strong></p> <p>Tor is a really tricky software to use for developers, as the slightest mistake can tear down the anonymity it provides. As BTCPay is evolving into a rather complex service and adding more and more plugins, even if we tried to route all this traffic through Tor, we couldn't guarantee that there would never be leaks of data in clear.</p> <p>We think that the illusion of security is more dangerous that no security, or at least security we know is imperfect. So be aware that activating Tor doesn't prevent others to connect to your instance website, your bitcoin or lightning node in clear, <strong>it doesn't make you anonymous at all.</strong></p> <p>If you want to know more about the philosophy behind all this, you can read our <a href="https://medium.com/@BtcpayServer/about-tor-and-btcpay-server-2ec1e4bd5e51" target="_blank" rel="noopener noreferrer">article on  Medium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="how-to-access-the-onion-address-without-clearnet"><a href="#how-to-access-the-onion-address-without-clearnet" class="header-anchor">#</a> How to access the .onion address without clearnet?</h3> <p>To see the .onion address of your BTCPay instance without accessing it through the clearnet and clicking the Tor logo in top left corner, apply the following command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> /var/lib/docker/volumes/generated_tor_servicesdir/_data/BTCPayServer/hostname
</code></pre></div><h3 id="how-can-i-modify-or-deactivate-environment-variables"><a href="#how-can-i-modify-or-deactivate-environment-variables" class="header-anchor">#</a> How can I modify or deactivate environment variables?</h3> <p>In BTCPay, various options are activated through environment variables. You can modify or delete any of these options using command lines by exporting the new value with <code>export {environment variable}=&quot;{value}&quot;</code> and then running <code>. ./btcpay-setup.sh -i</code> again.</p> <p>For example, let's say I want to deactivate Tor for my BTCPay server:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Login as root</span>
<span class="token function">sudo</span> <span class="token function">su</span> -

<span class="token comment"># Go to the root/btcpayserver-docker directory</span>
<span class="token builtin class-name">cd</span> /root/btcpayserver-docker

<span class="token comment"># Print the complete list of options that you are running (for the sake of the demonstration, let's say that besides Tor you have pruning mode activated too)</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$BTCPAYGEN_ADDITIONAL_FRAGMENTS</span>
opt-save-storage-s<span class="token punctuation">;</span>opt-add-tor

<span class="token comment"># Export the BTCPAYGEN_ADDITIONAL_FRAGMENTS variable without opt-add-tor</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">BTCPAYGEN_ADDITIONAL_FRAGMENTS</span><span class="token operator">=</span><span class="token string">&quot;opt-save-storage-s&quot;</span>

<span class="token comment"># Run btcpay-setup.sh</span>
<span class="token builtin class-name">.</span> btcpay-setup.sh -i

<span class="token builtin class-name">exit</span>
</code></pre></div><p>Similarly if you are adding an environment variable, the export command would instead look like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Enable Tor in addition to your existing environment variables (such as pruning)</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">BTCPAYGEN_ADDITIONAL_FRAGMENTS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$BTCPAYGEN_ADDITIONAL_FRAGMENTS</span>;opt-add-tor&quot;</span>
</code></pre></div><p>If you need to figure out which environment variable you need to modify, have a look at <a href="https://github.com/btcpayserver/btcpayserver-docker#environment-variables" target="_blank" rel="noopener noreferrer">this list<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="how-can-i-run-btcpay-on-testnet"><a href="#how-can-i-run-btcpay-on-testnet" class="header-anchor">#</a> How can I run BTCPay on testnet?</h3> <p>Building on the section above, this is how you configure BTCPay to use <code>testnet</code> instead of the default <code>mainnet</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Export the NBITCOIN_NETWORK variable switching to testnet</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">NBITCOIN_NETWORK</span><span class="token operator">=</span><span class="token string">&quot;testnet&quot;</span>

<span class="token comment"># Run btcpay-setup.sh for the change to take effect</span>
<span class="token builtin class-name">.</span> btcpay-setup.sh -i
</code></pre></div><p>If you just want to test things quickly without deploying everything yourself, have a look at the <a href="/TryItOut/">Try It Out</a> section.
It provides links and explanations for a BTCPay testnet instance hosted by us.</p> <h3 id="can-i-start-btcpay-only-when-im-expecting-a-payment"><a href="#can-i-start-btcpay-only-when-im-expecting-a-payment" class="header-anchor">#</a> Can I start BTCPay only when I'm expecting a payment?</h3> <p>No, you need to keep your BTCPay running at all times so that your Bitcoin node stays in sync with the blockchain to verify transactions. If you only start it up every now and then, it would take a long time to catch up on verifying recent blocks, and your payments would not show up until much later.</p> <h3 id="can-i-connect-to-my-btcpay-bitcoin-p2p-on-port-8333"><a href="#can-i-connect-to-my-btcpay-bitcoin-p2p-on-port-8333" class="header-anchor">#</a> Can I connect to my BTCPay Bitcoin P2P on port 8333?</h3> <p>BTCPay's Bitcoin core node is not exposed externally by default. For BTCPay purposes, it is typically not in the interest of the user, as it increases the bandwidth requirement. BTCPay is also whitebinding connections to this port, so opening it would expose the node to potential DDoS.</p> <p>However, we expose a P2P connection to your full node on Tor. You can get the Tor address by running:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> /var/lib/docker/volumes/generated_tor_servicesdir/_data/BTC-P2P/hostname
</code></pre></div><p>Or via the <code>Server Settings</code> of your BTCPay Server instance, logged as an administrator.</p> <p>Please do not share this tor hidden service with untrusted parties. Connections to this hidden service are whitelisted by the bitcoin node, malicious peer would be able to DDoS your node.</p> <p>If you need to unsafely expose bitcoind P2P port 8333 (for example if you require P2P for Bisq, DOJO, Esplora, etc.) and you are using a docker deployment, you can use the <a href="https://github.com/btcpayserver/btcpayserver-docker/blob/master/README.md#generated-docker-compose" target="_blank" rel="noopener noreferrer">opt-unsafe-expose<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> additional fragment.</p> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>ONLY USE ON TRUSTED LAN OR WITH FIREWALL RULES WHITELISTING SPECIFIC HOSTS</p></div> <h3 id="how-can-i-renew-my-ssl-certificate"><a href="#how-can-i-renew-my-ssl-certificate" class="header-anchor">#</a> How can I renew my SSL certificate?</h3> <p>If your SSL certificate has expired for your BTCPay Server, you can manually renew it. For Docker deployments the easiest way to do this is to <a href="/Troubleshooting/#1-3-restarting-a-service">restart the container</a> named <code>letsencrypt-nginx-proxy-companion</code> on your server.</p> <h3 id="can-i-use-an-existing-nginx-server-as-a-reverse-proxy-with-ssl-termination"><a href="#can-i-use-an-existing-nginx-server-as-a-reverse-proxy-with-ssl-termination" class="header-anchor">#</a> Can I use an existing Nginx server as a reverse proxy with SSL termination?</h3> <p>Yes you can! Just make sure to use the proper configuration.</p> <p>Create an extra config file for your vhost in <code>/etc/nginx/sites-available/btcpayserver</code> and create a symlink for this file at <code>/etc/nginx/sites-enabled/btcpayserver</code></p> <p>The contents of this vhost file should look like this:</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">server</span> <span class="token punctuation">{</span>
	<span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>

	<span class="token keyword">root</span> <span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token punctuation">;</span>
	<span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm <span class="token keyword">index</span><span class="token punctuation">.</span>nginx<span class="token operator">-</span>debian<span class="token punctuation">.</span>html<span class="token punctuation">;</span>

	<span class="token comment"># Put your domain name here</span>
	<span class="token keyword">server_name</span> btcpay<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>com<span class="token punctuation">;</span>

	<span class="token comment"># Needed for Let's Encrypt verification</span>
	<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span><span class="token punctuation">.</span>well<span class="token operator">-</span>known <span class="token punctuation">{</span>
		<span class="token keyword">allow</span> all<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment"># Force HTTP to HTTPS</span>
	<span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">301</span> <span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$http_host</span><span class="token variable">$request_uri</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">server</span> <span class="token punctuation">{</span>
	<span class="token keyword">listen</span> <span class="token number">443</span> <span class="token keyword">ssl</span> http2<span class="token punctuation">;</span>

	<span class="token keyword">ssl</span> on<span class="token punctuation">;</span>

	<span class="token comment"># SSL certificate by Let's Encrypt in this Nginx (not using Let's Encyrpt that came with BTCPay Server Docker)</span>
	<span class="token keyword">ssl_certificate</span>      <span class="token operator">/</span>etc<span class="token operator">/</span>letsencrypt<span class="token operator">/</span>live<span class="token operator">/</span>btcpay<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>com<span class="token operator">/</span>fullchain<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>
	<span class="token keyword">ssl_certificate_key</span>  <span class="token operator">/</span>etc<span class="token operator">/</span>letsencrypt<span class="token operator">/</span>live<span class="token operator">/</span>btcpay<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>com<span class="token operator">/</span>privkey<span class="token punctuation">.</span>pem<span class="token punctuation">;</span>

	<span class="token keyword">root</span> <span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token punctuation">;</span>
	<span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm <span class="token keyword">index</span><span class="token punctuation">.</span>nginx<span class="token operator">-</span>debian<span class="token punctuation">.</span>html<span class="token punctuation">;</span>

	<span class="token comment"># Put your domain name here</span>
	<span class="token keyword">server_name</span> btcpay<span class="token punctuation">.</span>domain<span class="token punctuation">.</span>com<span class="token punctuation">;</span>

	<span class="token comment"># Route everything to the real BTCPay server</span>
	<span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
		<span class="token comment"># URL of BTCPay Server (i.e. a Docker installation with REVERSEPROXY_HTTP_PORT set to 10080)</span>
		<span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">10080</span><span class="token punctuation">;</span>

		<span class="token keyword">proxy_set_header</span> Host <span class="token variable">$http_host</span><span class="token punctuation">;</span>
		<span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>Proto <span class="token variable">$scheme</span><span class="token punctuation">;</span>
		<span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
		<span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>

		<span class="token comment"># For websockets (used by Ledger hardware wallets)</span>
		<span class="token keyword">proxy_set_header</span> Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment"># Needed for Let's Encrypt verification</span>
	<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span><span class="token punctuation">.</span>well<span class="token operator">-</span>known <span class="token punctuation">{</span>
		<span class="token keyword">allow</span> all<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Also, put the following in your main Nginx config file at <code>/etc/nginx/nginx.conf</code>:</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">http</span> <span class="token punctuation">{</span>

	<span class="token comment"># ... # Existing stuff</span>

	<span class="token comment"># Needed to allow very long URLs to prevent issues while signing PSBTs</span>
	<span class="token keyword">server_names_hash_bucket_size</span> <span class="token number">128</span><span class="token punctuation">;</span>
	<span class="token keyword">proxy_buffer_size</span>          <span class="token number">128</span>k<span class="token punctuation">;</span>
	<span class="token keyword">proxy_buffers</span>              <span class="token number">4</span> <span class="token number">256</span>k<span class="token punctuation">;</span>
	<span class="token keyword">proxy_busy_buffers_size</span>    <span class="token number">256</span>k<span class="token punctuation">;</span>
	<span class="token keyword">client_header_buffer_size</span> <span class="token number">500</span>k<span class="token punctuation">;</span>
	<span class="token keyword">large_client_header_buffers</span> <span class="token number">4</span> <span class="token number">500</span>k<span class="token punctuation">;</span>
	http2_max_field_size       <span class="token number">500</span>k<span class="token punctuation">;</span>
	http2_max_header_size      <span class="token number">500</span>k<span class="token punctuation">;</span>

	<span class="token comment"># Needed websocket support (used by Ledger hardware wallets)</span>
	<span class="token keyword">map</span> <span class="token variable">$http_upgrade</span> <span class="token variable">$connection_upgrade</span> <span class="token punctuation">{</span>
    	default upgrade<span class="token punctuation">;</span>
    	<span class="token string">''</span>      close<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><p>Now test your Nginx config with <code>service nginx configtest</code> and reload the config with <code>service nginx reload</code>.</p> <p>Then, you need to make sure that BTCPayServer does not try to handle HTTPS on its side, you can do this by disabling it on your BTCPayServer instance.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">BTCPAYGEN_EXCLUDE_FRAGMENTS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$BTCPAYGEN_EXCLUDE_FRAGMENTS</span>;nginx-https&quot;</span>
<span class="token builtin class-name">.</span> btcpay-setup.sh -i
</code></pre></div><p>Notice: If your BTCPay Server install has more than one domain (for example <code>WOOCOMMERCE_HOST</code> or <code>BTCPAY_ADDITIONAL_HOSTS</code>) you will need to modify your config for each domain name. The example above only covers 1 domain name called <code>btcpay.domain.com</code>.</p> <h2 id="web-deployment"><a href="#web-deployment" class="header-anchor">#</a> Web-deployment</h2> <p>Here you can find common questions and solutions to BTCPay web-deployments.</p> <h3 id="can-i-run-btcpay-on-my-home-computer"><a href="#can-i-run-btcpay-on-my-home-computer" class="header-anchor">#</a> Can I run BTCPay on my home computer?</h3> <p>Similar to the requirements for hosting a website, a web server is required for a BTCPay Server instance. While it is possible to run BTCPay Server locally on your PC, it would have to meet the minimal requirements and also run 24/7 if you don't want interruptions of service. You might also not want to expose your home IP address for the activity related to BTCPay Server payments. For all these reasons, while local hosting is suitable for testing, it's not a viable solution for production. A Virtual Private Server (VPS) is commonly used to address these problems.</p> <h3 id="lunanode-web-deployment"><a href="#lunanode-web-deployment" class="header-anchor">#</a> LunaNode web-deployment</h3> <h4 id="how-to-change-domain-name-on-my-lunanode-btcpay"><a href="#how-to-change-domain-name-on-my-lunanode-btcpay" class="header-anchor">#</a> How to change domain name on my LunaNode BTCPay?</h4> <ol><li>In your LunaNode dashboard, click on Virtual Machines &gt; Your Virtual Machine &gt; General Tab &gt; External IP. Copy the external IP.</li> <li>Go to your DNS provider and create an A record. Paste the external IP.</li> <li>Go to Server Settings &gt; Maintenance &gt; Change Domain. Paste yourdomain.com without http or https prefix.</li></ol> <p>Additional documentation can be found on <a href="/ChangeDomain/">domain change page</a>.</p> <h2 id="manual-deployment"><a href="#manual-deployment" class="header-anchor">#</a> Manual Deployment</h2> <h4 id="how-to-manually-install-btcpay-on-ubuntu-1804"><a href="#how-to-manually-install-btcpay-on-ubuntu-1804" class="header-anchor">#</a> How to manually install BTCPay on Ubuntu 18.04?</h4> <p>Check this <a href="https://freedomnode.com/blog/114/how-to-setup-btc-and-lightning-payment-gateway-with-btcpayserver-on-linux-manual-install" target="_blank" rel="noopener noreferrer">community guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="how-do-i-completely-uninstall-btcpay-from-a-linux-environment-docker-version"><a href="#how-do-i-completely-uninstall-btcpay-from-a-linux-environment-docker-version" class="header-anchor">#</a> How do I completely uninstall BTCPay from a linux environment (docker version)</h3> <ol><li>Shutdown BTCPay Server (after you ensure you have required backups etc) with <code>btcpay-down.sh</code> and cleanup the install with <code>btcpay-clean.sh</code>.</li> <li>Change to your Base install directory <code>cd &quot;$(dirname &quot;$BTCPAY_ENV_FILE&quot;)&quot;</code></li> <li>Delete all volumes in /var/lib/docker/volumes/ with <code>docker-compose -f $BTCPAY_DOCKER_COMPOSE down --v</code></li> <li>Remove other BTCPay system files with this: <code>rm /etc/systemd/system/btcpayserver.service &amp;&amp; rm /etc/profile.d/btcpay-env.sh</code></li> <li>Go into /usr/local/bin and remove all of the symlinks that BTCPay put in there.  At the time of writing these were:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>bitcoin-cli.sh -&gt; /root/BTCPayServer/btcpayserver-docker/bitcoin-cli.sh
bitcoin-lncli.sh -&gt; /root/BTCPayServer/btcpayserver-docker/bitcoin-lncli.sh
btcpay-admin.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-admin.sh
btcpay-clean.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-clean.sh
btcpay-down.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-down.sh
btcpay-restart.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-restart.sh
btcpay-setup.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-setup.sh
btcpay-up.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-up.sh
btcpay-update.sh -&gt; /root/BTCPayServer/btcpayserver-docker/btcpay-update.sh
changedomain.sh -&gt; /root/BTCPayServer/btcpayserver-docker/changedomain.sh
</code></pre></div><ol start="6"><li>Remove your BTCPay installation folder with <code>rm -r &quot;$(dirname &quot;$BTCPAY_ENV_FILE&quot;)&quot;</code></li> <li>Just to make sure, run <code>docker system prune</code> after a reboot to get rid of any other docker related artifacts.</li></ol> <h3 id="how-to-deploy-btcpay-server-alongside-existing-bitcoin-node"><a href="#how-to-deploy-btcpay-server-alongside-existing-bitcoin-node" class="header-anchor">#</a> How to deploy BTCPay Server alongside existing Bitcoin node?</h3> <p>The instructions below are valid for Docker deployments:</p> <ul><li>Run setup as described in <a href="https://github.com/btcpayserver/btcpayserver-docker#full-installation-for-technical-users" target="_blank" rel="noopener noreferrer">btcpayserver-docker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> up until <code>. ./btcpay-setup.sh -i</code></li> <li>Create <code>bitcoin.custom.yml</code> in the <code>docker-compose-generator/docker-fragments/</code> folder.</li></ul> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3&quot;</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">btcpayserver</span><span class="token punctuation">:</span>
      <span class="token key atrule">environment</span><span class="token punctuation">:</span>
        <span class="token key atrule">BTCPAY_CHAINS</span><span class="token punctuation">:</span> <span class="token string">&quot;btc&quot;</span>
        <span class="token key atrule">BTCPAY_BTCEXPLORERURL</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nbxplorer<span class="token punctuation">:</span>32838/
  <span class="token key atrule">nbxplorer</span><span class="token punctuation">:</span>
      <span class="token key atrule">environment</span><span class="token punctuation">:</span>
        <span class="token key atrule">NBXPLORER_CHAINS</span><span class="token punctuation">:</span> <span class="token string">&quot;btc&quot;</span>
        <span class="token key atrule">NBXPLORER_BTCRPCURL</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//host.docker.internal<span class="token punctuation">:</span>43782/
        <span class="token key atrule">NBXPLORER_BTCRPCUSER</span><span class="token punctuation">:</span> <span class="token string">&quot;rpc-username&quot;</span>
        <span class="token key atrule">NBXPLORER_BTCRPCPASSWORD</span><span class="token punctuation">:</span> <span class="token string">&quot;rpc-password&quot;</span>
        <span class="token key atrule">NBXPLORER_BTCNODEENDPOINT</span><span class="token punctuation">:</span> host.docker.internal<span class="token punctuation">:</span><span class="token number">39388</span>
      <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token string">&quot;localBitcoinfolder:/root/.bitcoin&quot;</span>
</code></pre></div><ul><li>Replace: <code>43782</code> with your bitcoin node's configured RPC port</li> <li>Replace: <code>rpc-username</code> with your bitcoin node's configured RPC username</li> <li>Replace: <code>rpc-password</code> with your bitcoin node's configured RPC password</li> <li>Replace: <code>39388</code> with your bitcoin node's configured p2p port</li> <li>Replace <code>localBitcoinfolder</code> with the path to your bitcoin data folder</li></ul> <p>If you are running on linux, due to <a href="https://github.com/docker/for-linux/issues/264" target="_blank" rel="noopener noreferrer">a limitation of docker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, you will also need to do the following:</p> <ul><li>Run <code>ip route | grep docker0 | awk '{print $9}'</code> <ul><li>Add the following at the end of the <code>bitcoin.custom.yml</code> file, replacing <code>$DOCKER_HOST_IP</code> with the result of the previous command.</li></ul></li></ul> <div class="language-yml extra-class"><pre class="language-yml"><code>      <span class="token key atrule">extra_hosts</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token string">&quot;host.docker.internal:$DOCKER_HOST_IP&quot;</span>
</code></pre></div><ul><li>Run <code>BTCPAYGEN_EXCLUDE_FRAGMENTS=&quot;bitcoin&quot;</code></li> <li>Run <code>BTCPAYGEN_ADDITIONAL_FRAGMENTS=&quot;$BTCPAYGEN_ADDITIONAL_FRAGMENTS&quot;</code></li> <li>Run <code>. ./btcpay-setup.sh -i</code></li></ul> <p>If you are looking for how to deploy alongside existing Lightning node <a href="/FAQ/FAQ-LightningNetwork/#can-i-use-my-existing-ln-node-with-btcpay">see this</a>.</p> <h3 id="with-the-docker-deployment-how-to-use-a-different-volume-for-the-data"><a href="#with-the-docker-deployment-how-to-use-a-different-volume-for-the-data" class="header-anchor">#</a> With the docker deployment, how to use a different volume for the data?</h3> <p>First, you need to make sure that btcpayserver and docker is not running</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">su</span> -
btcpay-down.sh
systemctl stop docker
</code></pre></div><p>Now, you need to format your drive. If you have already done it, you can skip this step.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Step 1: Unplug the drive</span>
lsblk

<span class="token comment"># Step 2: Plug the drive</span>
lsblk
</code></pre></div><p>The second <code>lsblk</code> should show the drive you just plugged in. (of TYPE <code>disk</code>)
Make sure you don't make a mistake as the next command will erase all data on this disk.</p> <p>For the sake of the example, let's suppose it has the NAME <code>/dev/sdd</code>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Save the name in a variable</span>
<span class="token assign-left variable">DEVICE_NAME</span><span class="token operator">=</span><span class="token string">&quot;/dev/sdd&quot;</span>
<span class="token comment"># Set the partition name</span>
<span class="token assign-left variable">PARTITION_NAME</span><span class="token operator">=</span><span class="token string">&quot;/dev/sdd1&quot;</span>
</code></pre></div><p>Now we can partition the disk and format the partition:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;Partitioning the external drive <span class="token variable">$DEVICE_NAME</span>...&quot;</span>
<span class="token comment">### DANGER ZONE ###</span>
<span class="token punctuation">(</span>
	<span class="token builtin class-name">echo</span> o <span class="token comment"># Create a new empty DOS partition table</span>
	<span class="token builtin class-name">echo</span> n <span class="token comment"># Add a new partition</span>
	<span class="token builtin class-name">echo</span> p <span class="token comment"># Primary partition</span>
	<span class="token builtin class-name">echo</span> <span class="token number">1</span> <span class="token comment"># Partition number</span>
	<span class="token builtin class-name">echo</span>   <span class="token comment"># First sector (Accept default: 1)</span>
	<span class="token builtin class-name">echo</span>   <span class="token comment"># Last sector (Accept default: varies)</span>
	<span class="token builtin class-name">echo</span> w <span class="token comment"># Write changes</span>
<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">fdisk</span> <span class="token variable">${DEVICE_NAME}</span>
partprobe <span class="token variable">${DEVICE_NAME}</span>
<span class="token keyword">while</span> <span class="token operator">!</span> lsblk <span class="token variable">$PARTITION_NAME</span> <span class="token operator">&amp;&gt;</span> /dev/null<span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token function">sleep</span> <span class="token number">1</span>
<span class="token keyword">done</span>
mkfs.ext4 -F <span class="token string">&quot;<span class="token variable">$PARTITION_NAME</span>&quot;</span>
</code></pre></div><p>Then we need to mount the partition on the linux filesystem.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Mounting the partition</span>
<span class="token assign-left variable">MOUNT_DIR</span><span class="token operator">=</span><span class="token string">&quot;/mnt/external&quot;</span>
<span class="token function">mkdir</span> <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span>&quot;</span>
<span class="token function">mount</span> -o defaults,noatime <span class="token string">&quot;<span class="token variable">$PARTITION_NAME</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span>&quot;</span>

<span class="token comment"># Make sure the partition exists at the next reboot, we use UUID in case</span>
<span class="token comment"># the partition name is different in the next reboot</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">grep</span> -qF <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span>&quot;</span> /etc/fstab<span class="token punctuation">;</span> <span class="token keyword">then</span>
	<span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">sudo</span> blkid -s UUID -o value $PARTITION_NAME<span class="token variable">)</span></span>&quot;</span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot;UUID=<span class="token variable">$UUID</span> <span class="token variable">$MOUNT_DIR</span> ext4 defaults,noatime,nofail 0 2&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/fstab
<span class="token keyword">fi</span>
</code></pre></div><p>Then, we need to make sure that docker not start before the mount.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">MOUNT_UNIT</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span>systemd-escape --path <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span>&quot;</span><span class="token variable">)</span></span>.mount&quot;</span>
<span class="token assign-left variable">docker_service</span><span class="token operator">=</span><span class="token string">&quot;/lib/systemd/system/docker.service&quot;</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">grep</span> -qF <span class="token string">&quot;After=<span class="token variable">$MOUNT_UNIT</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$docker_service</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	<span class="token function">sed</span> -i <span class="token string">&quot;s/After=/After=<span class="token variable">$MOUNT_UNIT</span> /g&quot;</span> <span class="token string">&quot;<span class="token variable">$docker_service</span>&quot;</span>
<span class="token keyword">fi</span>
</code></pre></div><p>Now, imagine you want to put all the docker volume data on the previous partition</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">DOCKER_VOLUMES</span><span class="token operator">=</span><span class="token string">&quot;/var/lib/docker/volumes&quot;</span>
<span class="token comment"># Copy all the data from our volume to the mount directory (this can take a while)</span>
<span class="token function">cp</span> -a -r <span class="token string">&quot;<span class="token variable">$DOCKER_VOLUMES</span>/.&quot;</span> <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span>&quot;</span>
<span class="token comment"># Make the folder a mountpoint</span>
<span class="token function">rm</span> -rf <span class="token string">&quot;<span class="token variable">$DOCKER_VOLUMES</span>&quot;</span>
<span class="token function">mkdir</span> -p <span class="token string">&quot;<span class="token variable">$DOCKER_VOLUMES</span>&quot;</span>
<span class="token function">mount</span> --bind <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$DOCKER_VOLUMES</span>&quot;</span>
<span class="token comment"># Make sure the mountpoint is mounted after reboot</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">grep</span> -qF <span class="token string">&quot;<span class="token variable">$DOCKER_VOLUMES</span>&quot;</span> /etc/fstab<span class="token punctuation">;</span> <span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$MOUNT_DIR</span> <span class="token variable">$DOCKER_VOLUMES</span> none bind,nobootwait 0 2&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/fstab
<span class="token keyword">fi</span>
</code></pre></div><p>Now restart docker and btcpayserver</p> <div class="language-bash extra-class"><pre class="language-bash"><code>systemctl start docker
btcpay-up.sh
</code></pre></div><p>Note: We use mount bind instead of symbolic link because docker would complain when running <code>docker volume rm</code>.</p> <h3 id="i-get-503-service-temporarily-unavailable-nginx"><a href="#i-get-503-service-temporarily-unavailable-nginx" class="header-anchor">#</a> I get 503 Service Temporarily Unavailable nginx</h3> <h4 id="cause-1-trying-to-access-my-btcpay-by-ip-address"><a href="#cause-1-trying-to-access-my-btcpay-by-ip-address" class="header-anchor">#</a> Cause 1: Trying to access my BTCPay by IP address</h4> <p>Your nginx config is set to route the HTTP request to a particular container based on the domain name of the request. For example, the official <a href="/RPi4/">deployment on pi 4</a> was to setup the souce domain name to http://raspberrypi.local/ yet getting automatic local domain raspberrypi.local does not always work. You are probably in this situation and trying to type the IP address of your BTCPay into the web-browser.</p> <p>Since nginx gets the IP address in the request instead of raspberrypi.local it does not know where to route that request and returns:</p> <div class="language- extra-class"><pre class="language-text"><code>503 Service Temporarily Unavailable
-----------------------------------
nginx
</code></pre></div><p>You can fix this by forcing nginx to route the HTTP request to BTCPay even if the request domain name is not recognized.
Simply, re-run the setup script like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">su</span> -

<span class="token assign-left variable">REVERSEPROXY_DEFAULT_HOST</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$BTCPAY_HOST</span>&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">.</span> btcpay-setup.sh -i
</code></pre></div><p>Now putting local IP in the web-browser works.</p> <h4 id="cause-2-btcpayserver-or-letsencrypt-nginx-proxy-is-not-running"><a href="#cause-2-btcpayserver-or-letsencrypt-nginx-proxy-is-not-running" class="header-anchor">#</a> Cause 2: btcpayserver or letsencrypt-nginx-proxy is not running</h4> <p>To check, run:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span>  docker <span class="token function">ps</span> <span class="token operator">|</span> <span class="token function">less</span> -S
</code></pre></div><p>Press &quot;q&quot; to quit out of less.</p> <p>The output should contain:</p> <ul><li>btcpayserver/letsencrypt-nginx-proxy-companion</li> <li>btcpayserver/btcpayserver</li></ul> <p>And the status should be &quot;Up&quot;</p> <p>If the docker container is not running, then check the reason for crash like this:</p> <div class="language-bash extra-class"><pre class="language-bash"><code> <span class="token function">sudo</span>  docker logs 6a6b9fd75692 --tail <span class="token number">20</span>
</code></pre></div><p>Where 6a6b9fd75692 is the container ID that is having issues.</p> <h4 id="cause-3-btcpay-is-expecting-you-to-access-this-website-from"><a href="#cause-3-btcpay-is-expecting-you-to-access-this-website-from" class="header-anchor">#</a> Cause 3: BTCPay is expecting you to access this website from</h4> <p>You might also see the following error: <code>You access BTCPay Server over an unsecured network</code>.</p> <p>You might see this error on the front page of your BTCPay Server since version <code>1.0.3.73</code>.</p> <p>This is caused by a breaking change made in BTCPay to be able to handle different domain on the same server.</p> <p>It happens because your BTCPay Server is not exposed directly on internet, instead a reverse proxy (like nginx or IIS) receive the request and forward it to BTCPay Server.</p> <p>Sadly, depending on the configuration of your reverse proxy, either the HTTP HOST header has been replaced, or the reverse proxy did not forwarded the protocol at the front with the http header <code>X-Forwarded-Proto</code>.</p> <p>If you use NGinx, here is what you need to have at the top level in <code>/etc/nginx/conf.d/default.conf</code>:</p> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token keyword">map</span> <span class="token variable">$http_x_forwarded_proto</span> <span class="token variable">$proxy_x_forwarded_proto</span> <span class="token punctuation">{</span>
  default <span class="token variable">$http_x_forwarded_proto</span><span class="token punctuation">;</span>
  <span class="token string">''</span>      <span class="token variable">$scheme</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">proxy_set_header</span> Host <span class="token variable">$http_host</span><span class="token punctuation">;</span>
<span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>Proto <span class="token variable">$proxy_x_forwarded_proto</span><span class="token punctuation">;</span>

<span class="token keyword">server_names_hash_bucket_size</span> <span class="token number">128</span><span class="token punctuation">;</span>
<span class="token keyword">proxy_buffer_size</span>          <span class="token number">128</span>k<span class="token punctuation">;</span>
<span class="token keyword">proxy_buffers</span>              <span class="token number">4</span> <span class="token number">256</span>k<span class="token punctuation">;</span>
<span class="token keyword">proxy_busy_buffers_size</span>    <span class="token number">256</span>k<span class="token punctuation">;</span>
<span class="token keyword">client_header_buffer_size</span> <span class="token number">500</span>k<span class="token punctuation">;</span>
<span class="token keyword">large_client_header_buffers</span> <span class="token number">4</span> <span class="token number">500</span>k<span class="token punctuation">;</span>
http2_max_field_size       <span class="token number">500</span>k<span class="token punctuation">;</span>
http2_max_header_size      <span class="token number">500</span>k<span class="token punctuation">;</span>
</code></pre></div><p>If your reverse proxy is Apache 2, you need to set those two settings</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;VirtualHost *:443&gt;
    RequestHeader set X-Forwarded-Proto &quot;https&quot;
    ProxyPreserveHost on
...
&lt;/VirtualHost&gt;
</code></pre></div><p>You will also need those settings in the <code>apache2.conf</code> to prevent issues while signing PSBTs.</p> <div class="language- extra-class"><pre class="language-text"><code>LimitRequestLine 500000
LimitRequestFieldSize 500000
</code></pre></div><h4 id="cause-4-getting-500-nginx-error-on-a-local-server-https-and-for-http-btcpay-is-expecting-you-to-access-this-website-from"><a href="#cause-4-getting-500-nginx-error-on-a-local-server-https-and-for-http-btcpay-is-expecting-you-to-access-this-website-from" class="header-anchor">#</a> Cause 4: Getting 500 nginx error on a local server https and for http BTCPay is expecting you to access this website from</h4> <p>You need to open port 80 and 443. Once you did that, restart docker <code>btcpay-restart.sh</code></p> <h4 id="cause-5-other"><a href="#cause-5-other" class="header-anchor">#</a> Cause 5: Other</h4> <p>There could be many causes for 5XX HTTP errors. Please create an <a href="https://github.com/btcpayserver/btcpayserver-docker/issues" target="_blank" rel="noopener noreferrer">Issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and when cause becomes known add it here in the <a href="/FAQ/FAQ-Deployment/" aria-current="page" class="router-link-exact-active router-link-active">Deployment FAQ</a> doc.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/btcpayserver/btcpayserver-doc/edit/master/docs/FAQ/FAQ-Deployment.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="edit-link"><a href="https://github.com/btcpayserver/btcpayserver-doc/issues/new?title=Improve%20BTCPay%20Deployment%20Frequently%20Asked%20Questions&amp;body=I%20could%20not%20find%20the%20information%20I%20was%20looking%20for%20on%20the%20%22BTCPay%20Deployment%20Frequently%20Asked%20Questions%22%20page%20(%60%2FFAQ%2FFAQ-Deployment%2F%60).%0A%0A%5BPLEASE%20DESCRIBE%20HOW%20THE%20PAGE%20CAN%20BE%20IMPROVED%5D&amp;labels=question" target="_blank" rel="noopener noreferrer">Didn't find an answer?</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/FAQ/FAQ-General/" class="prev">
        General FAQ
      </a></span> <span class="next"><a href="/FAQ/FAQ-Synchronization/">
        Synchronization FAQ
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3e743670.js" defer></script><script src="/assets/js/3.aa1712e0.js" defer></script><script src="/assets/js/76.e7ae2c11.js" defer></script><script src="/assets/js/28.ed6af585.js" defer></script>
  </body>
</html>
